function [r,th] = footContact_pol(footAngle)
% [r,q] = footContact_pol(footAngle)
%
% Given the angle of Ranger's foot, compute the position of the contact
% point with respect the the center of the ankle joint.
%
% r = distance between contact point and ankle joint
% th = absolute angle between the negative j axis, and the vector from the
% ankle joint to the contact point. th==0 implies that the contact point is
% directly below the ankle. th < 0 imcd ~plies that the contact point is more
% towards the front of the foot.
%
% To convert to cartesian...  (position with respect to the ankle joint)
% x =  r*sin(th)
% y = -r*cos(th)
%

footAngle = wrapToPi(footAngle);

qFoot = [-3.14159265, -3.09970475, -3.05781685, -3.01592895, -2.97404105, -2.93215314, -2.89026524, -2.84837734, -2.80648944, -2.76460154, -2.72271363, -2.68082573, -2.63893783, -2.59704993, -2.55516202, -2.51327412, -2.47138622, -2.42949832, -2.38761042, -2.34572251, -2.30383461, -2.26194671, -2.22005881, -2.17817091, -2.13628300, -2.09439510, -2.05250720, -2.01061930, -1.96873140, -1.92684349, -1.88495559, -1.84306769, -1.80117979, -1.75929189, -1.71740398, -1.67551608, -1.63362818, -1.59174028, -1.54985238, -1.50796447, -1.46607657, -1.42418867, -1.38230077, -1.34041287, -1.29852496, -1.25663706, -1.21474916, -1.17286126, -1.13097336, -1.08908545, -1.04719755, -1.00530965, -0.96342175, -0.92153385, -0.87964594, -0.83775804, -0.79587014, -0.75398224, -0.71209433, -0.67020643, -0.62831853, -0.58643063, -0.54454273, -0.50265482, -0.46076692, -0.41887902, -0.37699112, -0.33510322, -0.29321531, -0.25132741, -0.20943951, -0.16755161, -0.12566371, -0.08377580, -0.04188790, 0.00000000, 0.04188790, 0.08377580, 0.12566371, 0.16755161, 0.20943951, 0.25132741, 0.29321531, 0.33510322, 0.37699112, 0.41887902, 0.46076692, 0.50265482, 0.54454273, 0.58643063, 0.62831853, 0.67020643, 0.71209433, 0.75398224, 0.79587014, 0.83775804, 0.87964594, 0.92153385, 0.96342175, 1.00530965, 1.04719755, 1.08908545, 1.13097336, 1.17286126, 1.21474916, 1.25663706, 1.29852496, 1.34041287, 1.38230077, 1.42418867, 1.46607657, 1.50796447, 1.54985238, 1.59174028, 1.63362818, 1.67551608, 1.71740398, 1.75929189, 1.80117979, 1.84306769, 1.88495559, 1.92684349, 1.96873140, 2.01061930, 2.05250720, 2.09439510, 2.13628300, 2.17817091, 2.22005881, 2.26194671, 2.30383461, 2.34572251, 2.38761042, 2.42949832, 2.47138622, 2.51327412, 2.55516202, 2.59704993, 2.63893783, 2.68082573, 2.72271363, 2.76460154, 2.80648944, 2.84837734, 2.89026524, 2.93215314, 2.97404105, 3.01592895, 3.05781685, 3.09970475, 3.14159265];  % Foot orientation 
r = [0.02612018, 0.02768239, 0.02909430, 0.03043722, 0.03173923, 0.03301817, 0.03428252, 0.03553470, 0.03677694, 0.03801313, 0.03924230, 0.04048449, 0.09228062, 0.09624842, 0.09881768, 0.10073581, 0.10221837, 0.10342226, 0.10439739, 0.10520783, 0.10588051, 0.10644749, 0.10693557, 0.10734559, 0.10770622, 0.10801567, 0.10827940, 0.10851814, 0.10872356, 0.10890364, 0.10906067, 0.10920053, 0.10932428, 0.10942997, 0.10952499, 0.10960701, 0.10967699, 0.10973769, 0.10978917, 0.10983029, 0.10986290, 0.10988708, 0.10990291, 0.10991048, 0.10990973, 0.10990038, 0.10988184, 0.10985440, 0.10981569, 0.10976729, 0.10970574, 0.10963168, 0.10954209, 0.10943554, 0.10930759, 0.10915597, 0.10897483, 0.10876115, 0.10849908, 0.10817853, 0.10777357, 0.10723280, 0.10641278, 0.10276799, 0.09715281, 0.09181423, 0.08673752, 0.08193891, 0.07742757, 0.07324934, 0.06947315, 0.06619884, 0.06354709, 0.06160451, 0.06041510, 0.06000006, 0.06040268, 0.06168167, 0.06197344, 0.06206289, 0.06211816, 0.06215260, 0.06217153, 0.06217761, 0.06217255, 0.06215716, 0.06213227, 0.06209820, 0.06205407, 0.06200138, 0.06193873, 0.06186596, 0.06178156, 0.06168493, 0.06157718, 0.06145454, 0.06131597, 0.06116043, 0.06098451, 0.06078406, 0.06055975, 0.06030408, 0.06001440, 0.05968128, 0.05929728, 0.05885429, 0.05833953, 0.05773464, 0.05701040, 0.05614006, 0.05505255, 0.05363072, 0.05142113, 0.02646460, 0.02640422, 0.02635945, 0.02631939, 0.02628054, 0.02624067, 0.02619828, 0.02615207, 0.02610145, 0.02604561, 0.02598417, 0.02591660, 0.02584281, 0.02576234, 0.02567519, 0.02558111, 0.02547980, 0.02537119, 0.02525545, 0.02513241, 0.02500190, 0.02486401, 0.02471871, 0.02456603, 0.02440612, 0.02423907, 0.02406489, 0.02388395, 0.02369656, 0.02350298, 0.02330445, 0.02310201, 0.02289860, 0.02270018, 0.02252346, 0.02244883, 0.02407278, 0.02612018];  % distance 
q = [-0.49037500, -0.54962500, -0.58562500, -0.60993750, -0.62687500, -0.63881250, -0.64706250, -0.65237500, -0.65531250, -0.65637500, -0.65581250, -0.65450000, -1.18925000, -1.16475000, -1.13462500, -1.10206250, -1.06787500, -1.03268750, -0.99662500, -0.95993750, -0.92268750, -0.88500000, -0.84700000, -0.80862500, -0.77006250, -0.73125000, -0.69218750, -0.65306250, -0.61375000, -0.57431250, -0.53475000, -0.49512500, -0.45543750, -0.41562500, -0.37581250, -0.33593750, -0.29600000, -0.25606250, -0.21612500, -0.17612500, -0.13612500, -0.09612500, -0.05612500, -0.01612500, 0.02381250, 0.06375000, 0.10362500, 0.14350000, 0.18325000, 0.22300000, 0.26262500, 0.30218750, 0.34162500, 0.38093750, 0.42006250, 0.45900000, 0.49768750, 0.53612500, 0.57412500, 0.61162500, 0.64837500, 0.68387500, 0.71668750, 0.71918750, 0.69537500, 0.66762500, 0.63493750, 0.59643750, 0.55075000, 0.49668750, 0.43318750, 0.35993750, 0.27825000, 0.19018750, 0.09781250, 0.00193750, -0.09693750, -0.19662500, -0.17850000, -0.14537500, -0.11037500, -0.07443750, -0.03793750, -0.00100000, 0.03618750, 0.07356250, 0.11112500, 0.14881250, 0.18650000, 0.22431250, 0.26212500, 0.29993750, 0.33768750, 0.37537500, 0.41306250, 0.45062500, 0.48806250, 0.52537500, 0.56250000, 0.59937500, 0.63606250, 0.67243750, 0.70850000, 0.74412500, 0.77925000, 0.81381250, 0.84768750, 0.88068750, 0.91250000, 0.94287500, 0.97100000, 0.99550000, 1.01068750, 0.05006250, 0.03950000, 0.03637500, 0.03606250, 0.03781250, 0.04118750, 0.04587500, 0.05143750, 0.05787500, 0.06487500, 0.07237500, 0.08018750, 0.08831250, 0.09656250, 0.10493750, 0.11331250, 0.12156250, 0.12962500, 0.13750000, 0.14506250, 0.15218750, 0.15881250, 0.16481250, 0.17006250, 0.17443750, 0.17775000, 0.17975000, 0.18018750, 0.17868750, 0.17468750, 0.16756250, 0.15612500, 0.13862500, 0.11168750, 0.06756250, -0.02075000, -0.35193750, -0.49037500];  % relative angle 

p = pwPoly2(qFoot,[r;q],footAngle);  %Piecewise quadratic interpolation

r = p(1,:);
th = p(2,:);

end